<%- include('../partials/header') %>
<div class="container h-100" id="container-show">
    <div class="row h-100">
        <div class="col-md-6" id="column-show">
<div>
    <img class="" id="sneaker-image" src="<%= sneaker.sneakerImage %>" alt=""> 
</div>
<div id="description">
    <h3 class="h3"><%= sneaker.sneakerName %></h3>
    <p class="h5"> <strong>Release Date:</strong> <%= sneaker.releaseDate %> </p>
    <p class="h5"><%= sneaker.sneakerDetails %> </p>
</div>
    </div>
<div class="col-md-6" id="column-show">
    <h3 id="community-talks" class="text-center">Community Talks</h3>
<div> 
      <% if (sneaker.comments.length) { %>
        <table class="table table-striped mb-4">
          <thead>
            <tr>
              <th scope="col">User</th>
              <th scope="col">Date</th>
              <th scope="col">Comment</th>
              <th scope="col">Cop or Drop</th>
            </tr>
          </thead>
          <tbody>
            <% let total=0 %>
              <% sneaker.comments.forEach(function(c) { %>
                  <tr>
                    <td class="comment-user row"><img alt="avatar" src="<%= c.userAvatar %>" referrerpolicy="no-referrer" ><%= c.userName %></td>
                    <td class="row">
                      <%= c.createdAt.toLocaleDateString() %>
                    </td>
                    <td>
                      <%= c.commentContent %>
                    </td>
                    <td>
                      <%= c.copOrDrop.toUpperCase() %>
                    </td>
                    <td>
                      <% if (user && user._id.equals(c.user)) { %>
                        <form action="/comments/<%= c._id %>?_method=DELETE" method="POST">
                          <button type="submit" class="btn btn-danger">X</button>
                        </form>
                      <% } %>
                      <!-- Later make this only appear when a person clicks the edit button by adding an event listener -->
                      <% if (user && user._id.equals(c.user)) { %>
                        <form action="/comments/<%= c._id %>?_method=PUT" method="POST">
                            <!-- Value attribute is being set to the comment's current text -->
                            <input name="text" value="<%= c.text %>">
                            <button type="submit">UPDATE COMMENT</button>
                          </form>
                        <button type="button" class="btn btn-primary">Edit</button>
                      <% } %>
                    </td>
            
        
                  </tr>
                  <% }); %>
          </tbody>
        </table>
        <% } else { %>
          <h5>No Comments Yet</h5>
          <% } %>

          <% if (user) { %>
            <form id="add-review-form" method="POST" action="/sneakers/<%= sneaker.id %>/comments">
                <div class="form-group">
                <label>Comment:</label>
                <textarea name="commentContent" class="form-control" placeholder="Add text here"></textarea>
                </div>
                <div class="form-group">
                <label>Cop or Drop:</label>
                <select name="copOrDrop" class="form-control">
                  <option value="cop">Cop</option>
                  <option value="drop">Drop</option>
                </select>
                </div>
                <input type="submit" value="Add Comment" class="btn btn-primary">
              </form>
        
              <% } else { %>
        
                <p id="must-login" class="mt-3 text-center btn-danger">You must login, in order to comment</p>
        
                <% } %>




            </div>
        </div>
    </div>
</div>




<%- include('../partials/footer') %>